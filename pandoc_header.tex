% pandoc_header.tex
% Header to improve PDF output: auto-scale images and allow line-breaking in code blocks
% Designed for use with xelatex or lualatex (--pdf-engine=xelatex or --pdf-engine=lualatex)

% fontspec is required for xelatex/lualatex (do not use with pdflatex)
\usepackage{fontspec}
\usepackage{microtype}

% Make images use their natural size but never exceed 60% of the text width; preserve aspect ratio
\usepackage{graphicx}
\usepackage{adjustbox}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>0.6\linewidth 0.6\linewidth \else \Gin@nat@width \fi}
\makeatother
\AtBeginDocument{\setkeys{Gin}{width=\maxwidth,keepaspectratio}}

% Allow breaking long lines in verbatim/code blocks
\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,breakanywhere}

% Smaller captions for figures/tables
\usepackage{caption}
\captionsetup{font=small}

% Optional: reduce spacing in tables (helps wide tables)
\usepackage{booktabs}
\usepackage{etoolbox}
\AtBeginEnvironment{tabular}{\small}
